# Weather Tracker API üå§Ô∏è

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ API –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–æ–≥–æ–¥—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º FastAPI, SQLAlchemy (PostgreSQL) –∏ —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á.

### Python: 3.12

## üõ† –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

* **FastAPI** ‚Äî –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫.
* **SQLAlchemy 2.0 + Alembic** ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –ë–î –∏ –º–∏–≥—Ä–∞—Ü–∏–∏.
* **Pydantic V2** ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ DTO.
* **APScheduler** ‚Äî —Ñ–æ–Ω–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–≥–æ–¥–µ.
* **Pytest** ‚Äî —é–Ω–∏—Ç –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.
* **Docker & Docker Compose** ‚Äî –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è.

---


## üîë –í–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **WeatherAPI** –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–≥–æ–¥–µ.

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ [weatherapi.com](https://www.weatherapi.com/).
2. –ü–æ–ª—É—á–∏—Ç–µ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π API Key –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ.
3. –î–æ–±–∞–≤—å—Ç–µ –µ–≥–æ –≤ —Ñ–∞–π–ª `.env` (–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `WEATHER_API_KEY`).

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ (Docker)

–î–ª—è –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (API + DB + Scheduler) –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã:

1. **–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env**` –≤ –∫–æ—Ä–Ω–µ–≤–æ–º –∫–∞—Ç–∞–ª–æ–≥–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∏–º–µ—Ä–∞:
```bash
DB_URL=postgresql+asyncpg://postgres:postgres@db:5432/weather
DB_USER=postgres
DB_PASSWORD=postgres
DB_DATABASE=weather
DB_HOST=db
WEATHER_API_KEY=YOUR_API_KEY

```


2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã**:
```bash
docker-compose up --build

```


*–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:8000*
*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Swagger: http://localhost:8000/docs*

---

### üîë –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)

–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `.env`. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ä–∞–∑–Ω–∏—Ü—É –≤ `DB_URL` –∏ `DB_HOST` –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–ø–æ—Å–æ–±–∞ –∑–∞–ø—É—Å–∫–∞:

| –°–ø–æ—Å–æ–± –∑–∞–ø—É—Å–∫–∞ | –•–æ—Å—Ç –≤ DB_URL | –ü—Ä–∏–º–µ—Ä |
| :--- | :--- | :--- |
| **–ü–æ–ª–Ω—ã–π Docker (Compose)** | `db` | `postgresql+asyncpg://user:pass@db:5432/db` |
| **–õ–æ–∫–∞–ª—å–Ω–æ (IDE + dev.yml)** | `localhost` | `postgresql+asyncpg://user:pass@localhost:5432/db` |

> **–í–∞–∂–Ω–æ:** –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `docker-compose.dev.yml` –±–∞–∑–∞ –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ—Ç –ø–æ—Ä—Ç `5432` –Ω–∞ –≤–∞—à `localhost`, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å —Ç–µ—Å—Ç—ã –∏ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å –∫–æ–¥ –±–µ–∑ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤.

---

## üë®‚Äçüíª –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (.dev.yml)

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π `docker-compose.dev.yml`. –û–Ω –∑–∞–ø—É—Å–∫–∞–µ—Ç **—Ç–æ–ª—å–∫–æ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö**, —á—Ç–æ–±—ã –≤—ã –º–æ–≥–ª–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å API –∏ —Ç–µ—Å—Ç—ã –ª–æ–∫–∞–ª—å–Ω–æ –≤ –≤–∞—à–µ–π IDE.

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å —Å–æ–∑–¥–∞–Ω–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –Ω—É–∂–Ω–æ–π –≤–µ—Ä—Å–∏–∏:

### Windows
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
py -3.12 -m venv venv

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
.\venv\Scripts\activate

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

```

### Linux
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python3.12 -m venv venv

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
source venv/bin/activate

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

```

### 2. –ó–∞–ø—É—Å–∫ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ:

```bash
docker-compose -f docker-compose.dev.yml up -d

```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ë–î –∏ –∑–∞–ø—É—Å–∫

–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –±–∞–∑–∞ –ø–æ–¥–Ω—è–ª–∞—Å—å, –ø—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:

```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ Alembic
alembic upgrade head

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ —Ä–µ–∂–∏–º–µ hot-reload
python -m uvicorn src.main:app --reload

```



---

## üß™ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

–¢–µ—Å—Ç—ã –Ω–∞–ø–∏—Å–∞–Ω—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `pytest` –∏ `pytest-asyncio`. –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–æ–∫–∏ –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ —Å–µ—Ä–≤–∏—Å–æ–≤ –∏ `httpx` –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤.

**1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**

–ï—Å–ª–∏ –≤—ã –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤–ø–µ—Ä–≤—ã–µ, —Å–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏–º–µ–Ω–Ω–æ –¥–ª—è Python 3.12:

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
py -3.12 -m venv venv

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è (Windows)
.\venv\Scripts\activate

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt

```

**2. –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤:**

```bash
pytest -v

```

**3. –ó–∞–ø—É—Å–∫ —Å –æ—Ç—á–µ—Ç–æ–º –æ –ø–æ–∫—Ä—ã—Ç–∏–∏ (coverage):**

```bash
pytest --cov=src tests/

```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

* `src/core` ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —à–µ–¥—É–ª–µ—Ä.
* `src/db` ‚Äî –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î –∏ —Å–µ—Å—Å–∏–∏.
* `src/models` ‚Äî –º–æ–¥–µ–ª–∏ SQLAlchemy.
* `src/repositories` ‚Äî –ø–∞—Ç—Ç–µ—Ä–Ω Repository –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º.
* `src/services` ‚Äî –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (Service Layer).
* `src/schemas` ‚Äî Pydantic –º–æ–¥–µ–ª–∏ (DTO).
* `tests/` ‚Äî –ø–∞–ø–∫–∞ —Å —Ç–µ—Å—Ç–∞–º–∏ (Unit & API).

---

## üìã –û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

* `GET /api/v1/weather/` ‚Äî —Å–ø–∏—Å–æ–∫ –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –ø–æ–≥–æ–¥—ã –ø–æ –≤—Å–µ–º –≥–æ—Ä–æ–¥–∞–º.
* `GET /api/v1/weather/city/{city}` ‚Äî –ø–æ—Å–ª–µ–¥–Ω—è—è –∑–∞–ø–∏—Å—å –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –≥–æ—Ä–æ–¥–∞.
* `POST /api/v1/weather/refresh` ‚Äî –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ –≤–Ω–µ—à–Ω–∏–π API.
* `DELETE /api/v1/weather/{id}` ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏.
